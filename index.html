<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VetStock - Inventario Veterinario</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Import Map para dependencias (Incluye jsPDF para generar PDFs reales) -->
    <script type="importmap">
    {
        "imports": {
            "react": "https://esm.sh/react@18.2.0",
            "react-dom/client": "https://esm.sh/react-dom@18.2.0/client",
            "lucide-react": "https://esm.sh/lucide-react@0.344.0",
            "firebase/app": "https://www.gstatic.com/firebasejs/10.13.0/firebase-app.js",
            "firebase/auth": "https://www.gstatic.com/firebasejs/10.13.0/firebase-auth.js",
            "firebase/firestore": "https://www.gstatic.com/firebasejs/10.13.0/firebase-firestore.js",
            "jspdf": "https://esm.sh/jspdf@2.5.1",
            "jspdf-autotable": "https://esm.sh/jspdf-autotable@3.8.2"
        }
    }
    </script>

    <!-- Babel para JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <style>
        @keyframes fade-in { from { opacity: 0; } to { opacity: 1; } }
        @keyframes slide-up { from { transform: translateY(2.5rem); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
        .animate-in { animation-duration: 0.3s; animation-fill-mode: both; }
        .fade-in { animation-name: fade-in; }
        /* Animación suave para el modal de alerta */
        @keyframes pop-in { from { transform: scale(0.95); opacity: 0; } to { transform: scale(1); opacity: 1; } }
        .pop-in { animation: pop-in 0.2s ease-out forwards; }
    </style>
</head>
<body class="bg-slate-50">
    <div id="root"></div>

    <script type="text/babel" data-type="module">
        import React, { useState, useEffect, useRef, useMemo } from 'react';
        import { createRoot } from 'react-dom/client';
        import { Camera, Save, Trash2, Package, Activity, Search, X, Loader2, Plus, ScanLine, Pill, ShoppingBag, Gamepad2, Gem, Edit, Download, FileText, Image as ImageIcon, AlertTriangle, CheckCircle, AlertCircle } from 'lucide-react';
        import { initializeApp } from 'firebase/app';
        import { getAuth, signInAnonymously, onAuthStateChanged, signInWithCustomToken } from 'firebase/auth';
        import { getFirestore, collection, addDoc, deleteDoc, doc, updateDoc, onSnapshot, query, orderBy, serverTimestamp } from 'firebase/firestore';
        import { jsPDF } from 'jspdf';
        import autoTable from 'jspdf-autotable';

        // --- CONFIGURACIÓN API KEY ---
        const apiKey = ""; 

        // --- CONFIGURACIÓN FIREBASE ---
        const firebaseConfig = JSON.parse(__firebase_config || '{}');
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
        const initialAuthToken = typeof __initial_auth_token !== 'undefined' ? __initial_auth_token : null;

        // --- UTILIDADES ---
        const compressImage = (file) => {
            return new Promise((resolve) => {
                const reader = new FileReader();
                reader.readAsDataURL(file);
                reader.onload = (event) => {
                    const img = new Image();
                    img.src = event.target.result;
                    img.onload = () => {
                        const canvas = document.createElement('canvas');
                        const MAX_WIDTH = 500;
                        const MAX_HEIGHT = 500;
                        let width = img.width;
                        let height = img.height;
                        if (width > height) { if (width > MAX_WIDTH) { height *= MAX_WIDTH / width; width = MAX_WIDTH; } } 
                        else { if (height > MAX_HEIGHT) { width *= MAX_HEIGHT / height; height = MAX_HEIGHT; } }
                        canvas.width = width;
                        canvas.height = height;
                        const ctx = canvas.getContext('2d');
                        ctx.drawImage(img, 0, 0, width, height);
                        resolve(canvas.toDataURL('image/jpeg', 0.6));
                    };
                };
            });
        };

        const analyzeImageWithGemini = async (base64Image) => {
            try {
                const base64Data = base64Image.split(',')[1];
                const prompt = `Analiza esta imagen de producto veterinario. Identifica nombre, descripción breve y clasifícalo en: 'medicamento', 'juguetes', 'accesorios' o 'producto'. Devuelve JSON: { "name": string, "description": string, "type": string }.`;
                
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        contents: [{ parts: [{ text: prompt }, { inlineData: { mimeType: "image/jpeg", data: base64Data } }] }],
                        generationConfig: { responseMimeType: "application/json" }
                    })
                });

                if (!response.ok) throw new Error("API Error");
                const data = await response.json();
                const resultText = data.candidates?.[0]?.content?.parts?.[0]?.text;
                return resultText ? JSON.parse(resultText) : null;
            } catch (error) {
                console.error("AI Error:", error);
                return { name: "Producto Escaneado", description: "Editar detalles manuales.", type: "producto" };
            }
        };

        // --- COMPONENTES UI ---
        const Card = ({ children, className = "" }) => (
            <div className={`bg-white rounded-xl shadow-sm border border-slate-100 ${className}`}>{children}</div>
        );

        const Badge = ({ type }) => {
            let colorClass = '', icon = null, label = '';
            switch (type) {
                case 'medicamento': colorClass = 'bg-blue-100 text-blue-700 border-blue-200'; icon = <Pill size={12} />; label = 'Medicamento'; break;
                case 'juguetes': colorClass = 'bg-purple-100 text-purple-700 border-purple-200'; icon = <Gamepad2 size={12} />; label = 'Juguete'; break;
                case 'accesorios': colorClass = 'bg-amber-100 text-amber-700 border-amber-200'; icon = <Gem size={12} />; label = 'Accesorio'; break;
                default: colorClass = 'bg-emerald-100 text-emerald-700 border-emerald-200'; icon = <ShoppingBag size={12} />; label = 'Producto';
            }
            return (
                <span className={`px-2 py-0.5 rounded-full text-[10px] uppercase font-bold tracking-wide flex items-center gap-1 w-fit border ${colorClass}`}>
                    {icon} {label}
                </span>
            );
        };

        const Toast = ({ message, type, onClose }) => {
            useEffect(() => { const timer = setTimeout(onClose, 3000); return () => clearTimeout(timer); }, [onClose]);
            const styles = type === 'error' ? 'bg-red-50 text-red-800 border-red-200' : 'bg-slate-900 text-white border-slate-700';
            const Icon = type === 'error' ? AlertCircle : CheckCircle;
            return (
                <div className={`fixed top-4 left-1/2 -translate-x-1/2 z-50 flex items-center gap-2 px-4 py-3 rounded-full shadow-xl border ${styles} animate-in fade-in slide-in-from-top-4 duration-300`}>
                    <Icon size={18} /> <span className="text-sm font-medium">{message}</span>
                </div>
            );
        };

        function App() {
            const [user, setUser] = useState(null);
            const [items, setItems] = useState([]);
            const [loading, setLoading] = useState(true);
            const [analyzing, setAnalyzing] = useState(false);
            const [showModal, setShowModal] = useState(false);
            const [editingId, setEditingId] = useState(null);
            const [deleteId, setDeleteId] = useState(null); // Nuevo estado para controlar borrado
            const [imagePreview, setImagePreview] = useState(null);
            const [searchTerm, setSearchTerm] = useState("");
            const [toast, setToast] = useState(null);
            
            const [formData, setFormData] = useState({ name: '', description: '', type: 'producto', quantity: 1, price: '', imageBase64: null });
            const fileInputRef = useRef(null);

            useEffect(() => {
                const initAuth = async () => {
                    if (initialAuthToken) await signInWithCustomToken(auth, initialAuthToken);
                    else await signInAnonymously(auth);
                };
                initAuth();
                const unsubscribe = onAuthStateChanged(auth, setUser);
                return () => unsubscribe();
            }, []);

            useEffect(() => {
                if (!user) return;
                const q = query(collection(db, 'artifacts', appId, 'users', user.uid, 'inventory'));
                const unsubscribe = onSnapshot(q, (snapshot) => {
                    const loadedItems = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
                    loadedItems.sort((a, b) => (b.createdAt?.seconds || 0) - (a.createdAt?.seconds || 0));
                    setItems(loadedItems);
                    setLoading(false);
                });
                return () => unsubscribe();
            }, [user]);

            const showToast = (message, type = 'success') => setToast({ message, type });

            const handleImageUpload = async (e) => {
                const file = e.target.files[0];
                if (file) {
                    setAnalyzing(true); setShowModal(true); setEditingId(null); resetForm();
                    try {
                        const compressedBase64 = await compressImage(file);
                        setImagePreview(compressedBase64);
                        setFormData(prev => ({ ...prev, imageBase64: compressedBase64 }));
                        const result = await analyzeImageWithGemini(compressedBase64);
                        if (result) {
                            setFormData(prev => ({ ...prev, name: result.name || "Sin nombre", description: result.description || "", type: result.type || "producto" }));
                            showToast('¡Producto analizado!');
                        } else showToast('No se pudo analizar', 'error');
                    } catch (err) { showToast('Error en imagen', 'error'); } 
                    finally { setAnalyzing(false); }
                }
            };

            const handleSave = async () => {
                if (!formData.name || !user) return showToast('Nombre obligatorio', 'error');
                if(formData.price && isNaN(parseFloat(formData.price))) return showToast('Precio inválido', 'error');

                try {
                    setAnalyzing(true);
                    if (editingId) {
                        await updateDoc(doc(db, 'artifacts', appId, 'users', user.uid, 'inventory', editingId), { ...formData });
                        showToast('Actualizado');
                    } else {
                        await addDoc(collection(db, 'artifacts', appId, 'users', user.uid, 'inventory'), { ...formData, createdAt: serverTimestamp() });
                        showToast('Registrado');
                    }
                    setShowModal(false); resetForm();
                } catch (e) { showToast('Error al guardar', 'error'); } 
                finally { setAnalyzing(false); }
            };

            // --- LÓGICA DE BORRADO ---
            const requestDelete = (id) => {
                setDeleteId(id); // Solo abre el modal
            };

            const confirmDelete = async () => {
                if (!deleteId || !user) return;
                try {
                    await deleteDoc(doc(db, 'artifacts', appId, 'users', user.uid, 'inventory', deleteId));
                    showToast('Eliminado correctamente', 'success');
                } catch (error) {
                    console.error("Error al borrar:", error);
                    showToast('Error al eliminar', 'error');
                } finally {
                    setDeleteId(null); // Cierra el modal
                }
            };

            const handleEdit = (item) => {
                setFormData({ name: item.name, description: item.description, type: item.type, quantity: item.quantity, price: item.price, imageBase64: item.imageBase64 || null });
                setEditingId(item.id); setImagePreview(item.imageBase64 || null); setShowModal(true);
            };

            const resetForm = () => {
                setFormData({ name: '', description: '', type: 'producto', quantity: 1, price: '', imageBase64: null });
                setImagePreview(null); setAnalyzing(false);
            };

            const generatePDF = () => {
                if (items.length === 0) return showToast('No hay datos para exportar', 'error');
                const doc = new jsPDF();
                doc.setFontSize(22); doc.setTextColor(16, 185, 129); doc.text("VetStock", 14, 20);
                doc.setFontSize(12); doc.setTextColor(100); doc.text("Reporte de Inventario", 14, 28);
                doc.text(`Fecha: ${new Date().toLocaleDateString()}`, 14, 34);
                const totalMeds = items.filter(i => i.type === 'medicamento').length;
                const totalOthers = items.filter(i => i.type !== 'medicamento').length;
                doc.setFontSize(10); doc.text(`Resumen: ${totalMeds} Medicamentos | ${totalOthers} Otros | Total: ${items.length} ítems`, 14, 42);
                const tableColumn = ["Producto", "Categoría", "Stock", "Precio", "Descripción"];
                const tableRows = items.map(item => [item.name, item.type.toUpperCase(), item.quantity, item.price ? `$${item.price}` : '-', item.description || '']);
                autoTable(doc, { head: [tableColumn], body: tableRows, startY: 48, theme: 'grid', headStyles: { fillColor: [16, 185, 129], textColor: 255, fontStyle: 'bold' }, styles: { fontSize: 9, cellPadding: 3 }, columnStyles: { 0: { fontStyle: 'bold' }, 4: { cellWidth: 60 } } });
                doc.save(`inventario_vetstock_${new Date().toISOString().slice(0,10)}.pdf`);
                showToast('PDF Descargado', 'success');
            };

            const handleExportTxt = () => {
                let text = "INVENTARIO VETERINARIA\n======================\n\n";
                items.forEach(i => text += `[${i.type.toUpperCase()}] ${i.name} - Stock: ${i.quantity} - $${i.price}\n`);
                const blob = new Blob([text], { type: 'text/plain' });
                const link = document.createElement('a');
                link.href = URL.createObjectURL(blob);
                link.download = `inventario.txt`;
                link.click();
            };

            const filteredItems = useMemo(() => items.filter(i => i.name.toLowerCase().includes(searchTerm.toLowerCase())), [items, searchTerm]);
            const stats = useMemo(() => ({
                medicines: items.filter(i => i.type === 'medicamento').length,
                others: items.filter(i => i.type !== 'medicamento').length,
                lowStock: items.filter(i => i.quantity < 3).length
            }), [items]);

            if (loading) return <div className="flex h-screen items-center justify-center bg-slate-50 text-emerald-600"><Loader2 className="animate-spin" size={48} /></div>;

            return (
                <div className="min-h-screen bg-slate-50 text-slate-800 font-sans pb-24 relative">
                    {toast && <Toast message={toast.message} type={toast.type} onClose={() => setToast(null)} />}

                    {/* MODAL CONFIRMACIÓN BORRADO */}
                    {deleteId && (
                        <div className="fixed inset-0 z-[60] flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm animate-in fade-in duration-200">
                            <div className="bg-white rounded-2xl p-6 max-w-sm w-full shadow-2xl pop-in">
                                <div className="flex flex-col items-center text-center">
                                    <div className="bg-red-50 p-3 rounded-full mb-4">
                                        <Trash2 className="text-red-500" size={32} />
                                    </div>
                                    <h3 className="text-lg font-bold text-slate-900 mb-2">¿Estás seguro?</h3>
                                    <p className="text-sm text-slate-500 mb-6">Esta acción no se puede deshacer. El ítem será eliminado permanentemente.</p>
                                    <div className="flex gap-3 w-full">
                                        <button onClick={() => setDeleteId(null)} className="flex-1 py-2.5 px-4 bg-slate-100 hover:bg-slate-200 text-slate-700 font-bold rounded-xl transition-colors">Cancelar</button>
                                        <button onClick={confirmDelete} className="flex-1 py-2.5 px-4 bg-red-500 hover:bg-red-600 text-white font-bold rounded-xl transition-colors shadow-lg shadow-red-200">Eliminar</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    )}

                    <div className="bg-white px-6 pt-8 pb-6 shadow-sm sticky top-0 z-20 rounded-b-[2rem]">
                        <div className="flex justify-between items-center mb-6">
                            <div>
                                <h1 className="text-2xl font-black text-slate-900 tracking-tight flex items-center gap-2">
                                    <ScanLine className="text-emerald-500" strokeWidth={2.5} /> VetStock
                                </h1>
                            </div>
                            <div className="flex gap-2">
                                <button onClick={handleExportTxt} disabled={!items.length} className="p-2.5 bg-slate-50 hover:bg-slate-100 rounded-xl text-slate-600 disabled:opacity-50">
                                    <FileText size={20} />
                                </button>
                                <button onClick={generatePDF} disabled={!items.length} className="p-2.5 bg-slate-50 hover:bg-slate-100 rounded-xl text-slate-600 disabled:opacity-50" title="Descargar PDF">
                                    <Download size={20} />
                                </button>
                            </div>
                        </div>

                        <div className="grid grid-cols-3 gap-3">
                            <div className="bg-blue-50 p-3 rounded-2xl border border-blue-100 flex flex-col items-center justify-center">
                                <div className="text-blue-400 mb-1"><Pill size={18}/></div>
                                <div className="text-xl font-bold text-blue-700">{stats.medicines}</div>
                                <div className="text-[10px] font-bold text-blue-400 uppercase">Meds</div>
                            </div>
                            <div className="bg-emerald-50 p-3 rounded-2xl border border-emerald-100 flex flex-col items-center justify-center">
                                <div className="text-emerald-400 mb-1"><Package size={18}/></div>
                                <div className="text-xl font-bold text-emerald-700">{stats.others}</div>
                                <div className="text-[10px] font-bold text-emerald-400 uppercase">Gral</div>
                            </div>
                            <div className={`p-3 rounded-2xl border flex flex-col items-center justify-center ${stats.lowStock > 0 ? 'bg-red-50 border-red-100' : 'bg-slate-50 border-slate-100'}`}>
                                <div className={`${stats.lowStock > 0 ? 'text-red-400' : 'text-slate-400'} mb-1`}><AlertTriangle size={18}/></div>
                                <div className={`text-xl font-bold ${stats.lowStock > 0 ? 'text-red-600' : 'text-slate-600'}`}>{stats.lowStock}</div>
                                <div className={`text-[10px] font-bold uppercase ${stats.lowStock > 0 ? 'text-red-400' : 'text-slate-400'}`}>Bajo Stock</div>
                            </div>
                        </div>
                    </div>

                    <div className="px-5 py-6 max-w-3xl mx-auto">
                        <div className="relative mb-6 group">
                            <Search className="absolute left-4 top-1/2 -translate-y-1/2 text-slate-400 group-focus-within:text-emerald-500 transition-colors" size={20} />
                            <input type="text" placeholder="Buscar..." className="w-full pl-12 pr-4 py-4 bg-white border-none rounded-2xl shadow-sm focus:ring-2 focus:ring-emerald-500 outline-none" value={searchTerm} onChange={(e) => setSearchTerm(e.target.value)} />
                        </div>

                        {filteredItems.length === 0 ? (
                            <div className="text-center py-16 opacity-60 flex flex-col items-center">
                                <div className="bg-slate-200 p-4 rounded-full mb-4"><Package size={40} className="text-slate-400" /></div>
                                <p className="font-medium text-slate-500">Sin productos.</p>
                            </div>
                        ) : (
                            <div className="space-y-4">
                                {filteredItems.map(item => (
                                    <Card key={item.id} className="overflow-hidden flex h-32 hover:shadow-md transition-shadow">
                                        <div className="w-28 bg-slate-100 flex-shrink-0 relative">
                                            {item.imageBase64 ? <img src={item.imageBase64} className="w-full h-full object-cover" /> : <div className="w-full h-full flex items-center justify-center text-slate-300"><ImageIcon size={32} /></div>}
                                            {item.quantity < 3 && <div className="absolute bottom-0 left-0 right-0 bg-red-500/90 text-white text-[10px] font-bold text-center py-1">STOCK BAJO</div>}
                                        </div>
                                        <div className="p-3 flex-1 flex flex-col justify-between">
                                            <div>
                                                <div className="flex justify-between items-start mb-1">
                                                    <Badge type={item.type} />
                                                    <div className="flex gap-1">
                                                        <button onClick={() => handleEdit(item)} className="p-1.5 text-slate-400 hover:text-blue-600 hover:bg-blue-50 rounded-lg"><Edit size={16} /></button>
                                                        <button onClick={() => requestDelete(item.id)} className="p-1.5 text-slate-400 hover:text-red-600 hover:bg-red-50 rounded-lg"><Trash2 size={16} /></button>
                                                    </div>
                                                </div>
                                                <h3 className="font-bold text-slate-800 leading-tight line-clamp-1">{item.name}</h3>
                                                <p className="text-xs text-slate-500 line-clamp-1 mt-0.5">{item.description}</p>
                                            </div>
                                            <div className="flex justify-between items-end border-t border-slate-50 pt-2">
                                                <div className="flex flex-col"><span className="text-[10px] text-slate-400 font-bold uppercase">Cant.</span><span className={`text-sm font-bold ${item.quantity < 3 ? 'text-red-600' : 'text-slate-700'}`}>{item.quantity}</span></div>
                                                <div className="flex flex-col items-end"><span className="text-[10px] text-slate-400 font-bold uppercase">Precio</span><span className="text-lg font-black text-emerald-600">${item.price || '0'}</span></div>
                                            </div>
                                        </div>
                                    </Card>
                                ))}
                            </div>
                        )}
                    </div>

                    <div className="fixed bottom-6 w-full flex justify-center gap-4 px-6 z-30 pointer-events-none">
                        <input type="file" accept="image/*" capture="environment" ref={fileInputRef} className="hidden" onChange={handleImageUpload} />
                        <button onClick={() => { setEditingId(null); resetForm(); setShowModal(true); }} className="pointer-events-auto bg-white text-slate-900 p-4 rounded-full shadow-lg border hover:bg-slate-50"><Plus size={24} /></button>
                        <button onClick={() => fileInputRef.current?.click()} className="pointer-events-auto bg-slate-900 text-white pl-6 pr-8 py-4 rounded-full shadow-xl hover:bg-slate-800 flex items-center justify-center gap-3"><Camera size={24} /><span className="font-bold tracking-wide">Escanear</span></button>
                    </div>

                    {showModal && (
                        <div className="fixed inset-0 z-50 flex items-end sm:items-center justify-center p-0 sm:p-4 bg-slate-900/40 backdrop-blur-sm animate-in fade-in duration-200">
                            <div className="bg-white w-full max-w-md rounded-t-3xl sm:rounded-3xl shadow-2xl max-h-[95vh] overflow-y-auto">
                                <div className="sticky top-0 bg-white z-10 px-6 py-4 border-b border-slate-50 flex justify-between items-center">
                                    <h2 className="font-bold text-xl text-slate-800">{editingId ? 'Editar' : 'Nuevo'}</h2>
                                    <button onClick={() => { setShowModal(false); resetForm(); }} className="p-2 bg-slate-50 rounded-full hover:bg-slate-100"><X size={20} /></button>
                                </div>
                                <div className="p-6 space-y-5">
                                    <div className="w-full aspect-video bg-slate-50 rounded-2xl overflow-hidden border border-slate-100 relative" onClick={() => fileInputRef.current?.click()}>
                                        {imagePreview ? <img src={imagePreview} className="w-full h-full object-cover" /> : <div className="w-full h-full flex flex-col items-center justify-center text-slate-400"><Camera size={32} /><span className="text-xs">Agregar foto</span></div>}
                                        {analyzing && <div className="absolute inset-0 bg-black/50 flex flex-col items-center justify-center text-white backdrop-blur-sm"><ScanLine className="animate-pulse mb-2 text-emerald-400" size={32} /><span className="text-sm font-bold animate-pulse">Analizando...</span></div>}
                                    </div>
                                    <div className="space-y-4">
                                        <div><label className="block text-[11px] font-bold text-slate-400 uppercase tracking-wider mb-1.5">Nombre</label><input type="text" value={formData.name} onChange={(e) => setFormData({...formData, name: e.target.value})} className="w-full p-3.5 bg-slate-50 rounded-xl outline-none" disabled={analyzing} /></div>
                                        <div className="grid grid-cols-2 gap-4">
                                            <div><label className="block text-[11px] font-bold text-slate-400 uppercase tracking-wider mb-1.5">Precio</label><input type="number" value={formData.price} onChange={(e) => setFormData({...formData, price: e.target.value})} className="w-full p-3.5 bg-slate-50 rounded-xl outline-none" /></div>
                                            <div><label className="block text-[11px] font-bold text-slate-400 uppercase tracking-wider mb-1.5">Stock</label><div className="flex items-center bg-slate-50 rounded-xl overflow-hidden"><button onClick={() => setFormData(p => ({...p, quantity: Math.max(0, p.quantity - 1)}))} className="p-3.5 hover:bg-slate-200">-</button><input type="number" value={formData.quantity} readOnly className="w-full text-center bg-transparent font-bold outline-none" /><button onClick={() => setFormData(p => ({...p, quantity: p.quantity + 1}))} className="p-3.5 hover:bg-slate-200">+</button></div></div>
                                        </div>
                                        <div>
                                            <label className="block text-[11px] font-bold text-slate-400 uppercase tracking-wider mb-2">Categoría</label>
                                            <div className="grid grid-cols-2 gap-2">
                                                {['producto', 'medicamento', 'juguetes', 'accesorios'].map((type) => (
                                                    <button key={type} onClick={() => setFormData(prev => ({...prev, type}))} className={`py-2 px-3 rounded-lg text-xs font-bold capitalize border ${formData.type === type ? 'bg-slate-800 text-white' : 'bg-white text-slate-500'}`}>{type}</button>
                                                ))}
                                            </div>
                                        </div>
                                        <div><label className="block text-[11px] font-bold text-slate-400 uppercase tracking-wider mb-1.5">Descripción</label><textarea value={formData.description} onChange={(e) => setFormData({...formData, description: e.target.value})} rows={3} className="w-full p-3.5 bg-slate-50 rounded-xl outline-none resize-none" /></div>
                                        <button onClick={handleSave} disabled={analyzing} className="w-full bg-emerald-600 hover:bg-emerald-700 text-white py-4 rounded-xl font-bold flex items-center justify-center gap-2 mt-2">{analyzing ? <Loader2 className="animate-spin" /> : <Save size={20} />}<span>{analyzing ? '...' : 'Guardar'}</span></button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    )}
                </div>
            );
        }
        const root = createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
