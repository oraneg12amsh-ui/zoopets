<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ZOOTPETS | Premium Pet Care</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700;800&display=swap');
        
        :root {
            --primary: #f97316; /* Orange 500 */
            --secondary: #ea580c; /* Orange 600 */
            --dark: #111827;
        }

        body { 
            font-family: 'Outfit', sans-serif; 
            background-color: #fff7ed;
        }
        
        /* Scrollbar Personalizado */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #fff7ed; }
        ::-webkit-scrollbar-thumb { background: #fed7aa; border-radius: 10px; }
        ::-webkit-scrollbar-thumb:hover { background: #f97316; }

        /* Gradiente de Marca */
        .gradient-bg { background: linear-gradient(135deg, #f97316 0%, #c2410c 100%); }
        .gradient-text { background: linear-gradient(135deg, #f97316 0%, #c2410c 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        
        /* Efectos de Tarjeta */
        .card-hover { transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1); }
        .card-hover:hover { transform: translateY(-8px); box-shadow: 0 20px 40px -5px rgba(249, 115, 22, 0.15); }
        
        /* Modales y Glassmorphism */
        .modal { display: none; position: fixed; z-index: 3000; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(17, 24, 39, 0.7); backdrop-filter: blur(8px); }
        .modal.show { display: flex; align-items: center; justify-content: center; animation: fadeIn 0.3s ease-out; }
        
        /* Animaciones */
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes slideUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes bounce-short { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-25%); } }
        .animate-bounce-short { animation: bounce-short 0.5s ease-in-out 1; }

        /* Sidebar del Carrito */
        .cart-sidebar { transform: translateX(100%); transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1); }
        .cart-open .cart-sidebar { transform: translateX(0); }
        .cart-open .cart-overlay { opacity: 1; pointer-events: auto; }
        .cart-overlay { transition: opacity 0.4s ease; opacity: 0; pointer-events: none; }
        
        /* Loader */
        #loader { position: fixed; inset: 0; background: #fff7ed; z-index: 9999; display: flex; flex-direction: column; align-items: center; justify-content: center; transition: opacity 0.5s; }

        /* Offline Badge */
        .offline-badge { position: fixed; bottom: 20px; left: 20px; background-color: #dc2626; color: white; padding: 10px 20px; border-radius: 50px; font-size: 13px; font-weight: bold; z-index: 9998; box-shadow: 0 10px 15px -3px rgba(220, 38, 38, 0.3); display: none; animation: slideUp 0.5s ease; border: 2px solid white; }
        .offline-badge.visible { display: flex; align-items: center; gap: 8px; }
    </style>
</head>
<body class="flex flex-col min-h-screen text-gray-800">

    <!-- Loader -->
    <div id="loader">
        <div class="relative mb-4">
            <div class="animate-spin rounded-full h-20 w-20 border-t-4 border-b-4 border-orange-600"></div>
            <div class="absolute inset-0 flex items-center justify-center text-2xl">ü¶ä</div>
        </div>
        <h2 class="text-3xl font-extrabold text-gray-900 tracking-widest mb-2">ZOOTPETS</h2>
        <p class="text-orange-600 font-medium animate-pulse">Cargando experiencia...</p>
    </div>

    <!-- Badge Offline -->
    <div id="offline-badge" class="offline-badge">
        <i class="fas fa-wifi-slash"></i> 
        <span>MODO OFFLINE (Datos Locales)</span>
    </div>

    <!-- Header -->
    <header class="fixed w-full top-0 z-40 transition-all duration-300 bg-white/80 backdrop-blur-md border-b border-orange-100 shadow-sm">
        <div class="container mx-auto px-4 py-3">
            <div class="flex justify-between items-center">
                <!-- Logo -->
                <div class="flex items-center space-x-3 group cursor-pointer select-none" onclick="window.scrollToSection('hero')">
                    <div class="w-10 h-10 gradient-bg text-white rounded-xl flex items-center justify-center shadow-lg shadow-orange-500/30 group-hover:rotate-6 transition-transform duration-300">
                        <i class="fas fa-paw text-xl"></i>
                    </div>
                    <h1 class="text-2xl font-extrabold tracking-tighter text-gray-900">ZOOT<span class="text-orange-600">PETS</span></h1>
                </div>
                
                <!-- Desktop Nav -->
                <nav class="hidden md:flex space-x-1 bg-orange-50/50 p-1 rounded-full border border-orange-100">
                    <a href="#productos" onclick="window.scrollToSection('productos')" class="px-5 py-2 rounded-full text-sm font-bold text-gray-600 hover:bg-white hover:text-orange-600 hover:shadow-sm transition-all">Tienda</a>
                    <a href="#citas" onclick="window.scrollToSection('citas')" class="px-5 py-2 rounded-full text-sm font-bold text-gray-600 hover:bg-white hover:text-orange-600 hover:shadow-sm transition-all">Cl√≠nica</a>
                    <a href="#seguimiento" onclick="window.scrollToSection('seguimiento')" class="px-5 py-2 rounded-full text-sm font-bold text-gray-600 hover:bg-white hover:text-orange-600 hover:shadow-sm transition-all">Rastreo</a>
                </nav>

                <!-- Actions -->
                <div class="flex items-center space-x-3">
                    <button onclick="window.toggleCart()" class="relative p-3 hover:bg-orange-50 rounded-xl transition-all group border border-transparent hover:border-orange-100">
                        <i id="cart-icon" class="fas fa-shopping-cart text-xl text-gray-700 group-hover:text-orange-600 transition-colors"></i>
                        <span id="cart-count" class="absolute top-1 right-1 bg-red-500 text-white text-[10px] font-bold rounded-full w-5 h-5 flex items-center justify-center border-2 border-white transform scale-0 transition-transform duration-300">0</span>
                    </button>
                    
                    <button onclick="window.scrollToSection('admin')" class="hidden md:flex p-3 hover:bg-gray-100 rounded-xl text-gray-500 hover:text-gray-900 transition-all" title="Acceso Staff">
                        <i class="fas fa-user-shield text-lg"></i>
                    </button>

                    <button onclick="window.toggleMobileMenu()" class="md:hidden p-3 hover:bg-orange-50 rounded-xl text-gray-700">
                        <i class="fas fa-bars text-xl"></i>
                    </button>
                </div>
            </div>
            
            <!-- Mobile Menu -->
            <div id="mobile-menu" class="md:hidden hidden absolute top-full left-0 w-full bg-white border-b border-gray-100 shadow-xl animate-[fadeIn_0.2s_ease]">
                <div class="p-4 space-y-2">
                    <a href="#productos" onclick="window.mobileNav('productos')" class="block py-3 px-4 bg-orange-50 rounded-xl font-bold text-orange-900">üì¶ Tienda</a>
                    <a href="#citas" onclick="window.mobileNav('citas')" class="block py-3 px-4 hover:bg-gray-50 rounded-xl font-bold text-gray-600">üè• Cl√≠nica</a>
                    <a href="#seguimiento" onclick="window.mobileNav('seguimiento')" class="block py-3 px-4 hover:bg-gray-50 rounded-xl font-bold text-gray-600">üöö Rastreo</a>
                    <a href="#admin" onclick="window.mobileNav('admin')" class="block py-3 px-4 hover:bg-gray-50 rounded-xl font-bold text-gray-600">üîê Staff</a>
                </div>
            </div>
        </div>
    </header>

    <!-- Hero Section -->
    <section id="hero" class="relative pt-32 pb-24 overflow-hidden bg-gray-900">
        <div class="absolute inset-0">
            <img src="https://images.unsplash.com/photo-1450778869180-41d0601e046e?ixlib=rb-4.0.3&auto=format&fit=crop&w=1920&q=80" class="w-full h-full object-cover opacity-40" alt="Hero Background">
            <div class="absolute inset-0 bg-gradient-to-r from-gray-900 via-gray-900/80 to-transparent"></div>
        </div>
        
        <div class="container mx-auto px-4 relative z-10">
            <div class="max-w-3xl animate-[slideUp_0.6s_ease-out]">
                <div class="inline-flex items-center gap-2 bg-orange-500/20 border border-orange-500/30 backdrop-blur-sm text-orange-300 px-4 py-1.5 rounded-full text-xs font-bold mb-6 uppercase tracking-widest">
                    <span class="w-2 h-2 rounded-full bg-orange-500 animate-pulse"></span> Nueva Apertura
                </div>
                <h2 class="text-5xl md:text-7xl font-extrabold text-white mb-6 leading-[1.1]">
                    Felicidad pura para <br>
                    <span class="gradient-text">tu mejor amigo.</span>
                </h2>
                <p class="text-xl text-gray-300 mb-10 max-w-xl leading-relaxed">
                    En ZOOTPETS fusionamos tecnolog√≠a veterinaria avanzada con los productos m√°s divertidos del mercado. Todo lo que amas, en un solo lugar.
                </p>
                <div class="flex flex-col sm:flex-row gap-4">
                    <button onclick="window.scrollToSection('productos')" class="group gradient-bg text-white px-8 py-4 rounded-full font-bold hover:shadow-lg hover:shadow-orange-500/40 transition-all transform hover:-translate-y-1 flex items-center justify-center gap-3">
                        <span>Explorar Tienda</span>
                        <i class="fas fa-arrow-right group-hover:translate-x-1 transition-transform"></i>
                    </button>
                    <button onclick="window.scrollToSection('citas')" class="bg-white/10 backdrop-blur-md border border-white/20 text-white px-8 py-4 rounded-full font-bold hover:bg-white hover:text-gray-900 transition-all flex items-center justify-center gap-2">
                        <i class="far fa-calendar-check"></i> Agendar Cita
                    </button>
                </div>
            </div>
        </div>
    </section>

    <!-- Productos Section -->
    <section id="productos" class="py-24 bg-[#fff7ed]">
        <div class="container mx-auto px-4">
            <div class="text-center mb-16 max-w-2xl mx-auto">
                <span class="text-orange-600 font-bold tracking-widest uppercase text-xs mb-2 block">Cat√°logo Premium</span>
                <h2 class="text-4xl font-extrabold text-gray-900 mb-4">Favoritos de la Temporada</h2>
                <p class="text-gray-500">Seleccionamos cuidadosamente cada producto para garantizar la salud y diversi√≥n de tu mascota.</p>
            </div>

            <!-- Filter Bar -->
            <div class="bg-white p-2 rounded-[2rem] shadow-xl shadow-orange-100/50 border border-orange-100 mb-12 flex flex-col md:flex-row gap-4 justify-between items-center sticky top-24 z-30 backdrop-blur-xl bg-white/90">
                <div class="flex overflow-x-auto pb-2 md:pb-0 w-full md:w-auto gap-1 p-1 no-scrollbar" id="filters-container">
                    <button onclick="window.filterProducts('todos', this)" class="filter-btn active flex-shrink-0 px-6 py-2.5 rounded-full text-sm font-bold transition-all bg-gray-900 text-white shadow-lg">Todo</button>
                    <button onclick="window.filterProducts('alimento', this)" class="filter-btn flex-shrink-0 px-6 py-2.5 rounded-full text-sm font-bold transition-all text-gray-500 hover:bg-orange-50 hover:text-orange-600">Alimento</button>
                    <button onclick="window.filterProducts('juguetes', this)" class="filter-btn flex-shrink-0 px-6 py-2.5 rounded-full text-sm font-bold transition-all text-gray-500 hover:bg-orange-50 hover:text-orange-600">Juguetes</button>
                    <button onclick="window.filterProducts('medicamentos', this)" class="filter-btn flex-shrink-0 px-6 py-2.5 rounded-full text-sm font-bold transition-all text-gray-500 hover:bg-orange-50 hover:text-orange-600">Salud</button>
                    <button onclick="window.filterProducts('accesorios', this)" class="filter-btn flex-shrink-0 px-6 py-2.5 rounded-full text-sm font-bold transition-all text-gray-500 hover:bg-orange-50 hover:text-orange-600">Accesorios</button>
                </div>
                
                <div class="relative w-full md:w-72 mr-2">
                    <input type="text" id="search-product" oninput="window.searchProducts()" placeholder="Buscar producto..." class="w-full pl-12 pr-4 py-3 rounded-full bg-gray-50 border-none focus:ring-2 focus:ring-orange-500/50 transition-all text-sm font-medium">
                    <i class="fas fa-search absolute left-5 top-3.5 text-gray-400"></i>
                </div>
            </div>

            <div id="products-grid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8"></div>
        </div>
    </section>

    <!-- Citas Section -->
    <section id="citas" class="py-24 bg-white relative overflow-hidden">
        <!-- Decorativos de fondo -->
        <div class="absolute top-0 right-0 w-1/2 h-full bg-orange-50 skew-x-12 translate-x-20 -z-0"></div>
        
        <div class="container mx-auto px-4 relative z-10">
            <div class="max-w-6xl mx-auto bg-white rounded-3xl shadow-2xl shadow-gray-200 overflow-hidden flex flex-col lg:flex-row border border-gray-100">
                
                <!-- Info Side -->
                <div class="lg:w-2/5 gradient-bg p-12 text-white flex flex-col justify-center relative overflow-hidden">
                    <div class="relative z-10">
                        <div class="w-16 h-16 bg-white/20 backdrop-blur-md rounded-2xl flex items-center justify-center mb-8 text-3xl shadow-inner">ü©∫</div>
                        <h3 class="text-4xl font-extrabold mb-6">Cl√≠nica Veterinaria</h3>
                        <p class="mb-10 text-orange-50 text-lg leading-relaxed font-medium">
                            Profesionales apasionados listos para cuidar de tu compa√±ero. Tecnolog√≠a de punta y trato amoroso garantizado.
                        </p>
                        <div class="space-y-5">
                            <div class="flex items-center gap-4 bg-white/10 p-3 rounded-xl backdrop-blur-sm">
                                <div class="bg-white text-orange-600 rounded-full w-8 h-8 flex items-center justify-center font-bold flex-shrink-0">‚úì</div> 
                                <span class="font-semibold">Medicina Preventiva</span>
                            </div>
                            <div class="flex items-center gap-4 bg-white/10 p-3 rounded-xl backdrop-blur-sm">
                                <div class="bg-white text-orange-600 rounded-full w-8 h-8 flex items-center justify-center font-bold flex-shrink-0">‚úì</div> 
                                <span class="font-semibold">Cirug√≠a y Hospitalizaci√≥n</span>
                            </div>
                            <div class="flex items-center gap-4 bg-white/10 p-3 rounded-xl backdrop-blur-sm">
                                <div class="bg-white text-orange-600 rounded-full w-8 h-8 flex items-center justify-center font-bold flex-shrink-0">‚úì</div> 
                                <span class="font-semibold">Est√©tica & Spa</span>
                            </div>
                        </div>
                    </div>
                    <!-- C√≠rculos decorativos -->
                    <div class="absolute -bottom-24 -left-24 w-80 h-80 bg-white opacity-10 rounded-full blur-3xl"></div>
                    <div class="absolute -top-24 -right-24 w-64 h-64 bg-yellow-400 opacity-20 rounded-full blur-2xl"></div>
                </div>

                <!-- Form Side -->
                <div class="lg:w-3/5 p-8 lg:p-12 bg-white">
                    <h4 class="text-2xl font-bold text-gray-800 mb-8">Reserva tu Cita</h4>
                    <form id="appointment-form" class="space-y-6">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div class="space-y-2">
                                <label class="text-xs font-bold text-gray-500 uppercase tracking-wider ml-1">Propietario</label>
                                <div class="relative">
                                    <i class="far fa-user absolute left-4 top-3.5 text-gray-400"></i>
                                    <input type="text" id="owner-name" placeholder="Nombre completo" required class="w-full pl-10 pr-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:border-orange-500 focus:ring-2 focus:ring-orange-100 outline-none transition-all">
                                </div>
                            </div>
                            <div class="space-y-2">
                                <label class="text-xs font-bold text-gray-500 uppercase tracking-wider ml-1">Contacto</label>
                                <div class="relative">
                                    <i class="fab fa-whatsapp absolute left-4 top-3.5 text-gray-400"></i>
                                    <input type="tel" id="owner-phone" placeholder="N√∫mero celular" required class="w-full pl-10 pr-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:border-orange-500 focus:ring-2 focus:ring-orange-100 outline-none transition-all">
                                </div>
                            </div>
                        </div>

                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div class="space-y-2">
                                <label class="text-xs font-bold text-gray-500 uppercase tracking-wider ml-1">Paciente</label>
                                <div class="relative">
                                    <i class="fas fa-paw absolute left-4 top-3.5 text-gray-400"></i>
                                    <input type="text" id="pet-name" placeholder="Nombre de mascota" required class="w-full pl-10 pr-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:border-orange-500 focus:ring-2 focus:ring-orange-100 outline-none transition-all">
                                </div>
                            </div>
                            <div class="space-y-2">
                                <label class="text-xs font-bold text-gray-500 uppercase tracking-wider ml-1">Especie</label>
                                <div class="relative">
                                    <select id="pet-type" required class="w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:border-orange-500 focus:ring-2 focus:ring-orange-100 outline-none appearance-none">
                                        <option value="Perro">üê∂ Perro</option>
                                        <option value="Gato">üê± Gato</option>
                                        <option value="Ex√≥tico">ü¶é Ex√≥tico</option>
                                        <option value="Otro">‚ùì Otro</option>
                                    </select>
                                    <i class="fas fa-chevron-down absolute right-4 top-4 text-gray-400 text-xs pointer-events-none"></i>
                                </div>
                            </div>
                        </div>

                        <div class="space-y-2">
                            <label class="text-xs font-bold text-gray-500 uppercase tracking-wider ml-1">Motivo de Visita</label>
                            <div class="relative">
                                <select id="appointment-reason" onchange="window.handleReasonChange()" required class="w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:border-orange-500 focus:ring-2 focus:ring-orange-100 outline-none appearance-none">
                                    <option value="Consulta General - $300">ü©∫ Consulta General - $300</option>
                                    <option value="Vacunaci√≥n - $400">üíâ Vacunaci√≥n - $400</option>
                                    <option value="Est√©tica Completa - $250">‚úÇÔ∏è Est√©tica Completa - $250</option>
                                    <option value="Urgencia - $500">üö® Urgencia - $500</option>
                                    <option value="Domicilio - $450">üöë Visita a Domicilio - $450</option>
                                </select>
                                <i class="fas fa-chevron-down absolute right-4 top-4 text-gray-400 text-xs pointer-events-none"></i>
                            </div>
                        </div>

                        <div id="address-container" class="hidden animate-[fadeIn_0.3s_ease] space-y-2">
                            <label class="text-xs font-bold text-gray-500 uppercase tracking-wider ml-1">Direcci√≥n de Visita</label>
                            <textarea id="appointment-address" rows="2" class="w-full px-4 py-3 bg-orange-50 border border-orange-200 rounded-xl focus:border-orange-500 outline-none text-sm" placeholder="Calle, N√∫mero, Referencias..."></textarea>
                        </div>

                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div class="space-y-2">
                                <label class="text-xs font-bold text-gray-500 uppercase tracking-wider ml-1">Fecha</label>
                                <input type="date" id="appointment-date" required class="w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:border-orange-500 focus:ring-2 focus:ring-orange-100 outline-none text-gray-600">
                            </div>
                            <div class="space-y-2">
                                <label class="text-xs font-bold text-gray-500 uppercase tracking-wider ml-1">Hora</label>
                                <div class="relative">
                                    <select id="appointment-time" required class="w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:border-orange-500 focus:ring-2 focus:ring-orange-100 outline-none appearance-none">
                                        <option value="09:00">09:00 AM</option>
                                        <option value="10:00">10:00 AM</option>
                                        <option value="11:00">11:00 AM</option>
                                        <option value="12:00">12:00 PM</option>
                                        <option value="16:00">04:00 PM</option>
                                        <option value="17:00">05:00 PM</option>
                                        <option value="18:00">06:00 PM</option>
                                    </select>
                                    <i class="fas fa-clock absolute right-4 top-4 text-gray-400 text-xs pointer-events-none"></i>
                                </div>
                            </div>
                        </div>

                        <button type="submit" class="w-full bg-gray-900 text-white py-4 px-6 rounded-xl font-bold hover:bg-orange-600 transform hover:-translate-y-1 transition-all shadow-lg text-lg flex justify-center items-center gap-3">
                            <span>Confirmar por WhatsApp</span>
                            <i class="fab fa-whatsapp text-xl"></i>
                        </button>
                    </form>
                </div>
            </div>
        </div>
    </section>

    <!-- Seguimiento Section -->
    <section id="seguimiento" class="py-24 bg-gray-50 border-t border-gray-200">
        <div class="container mx-auto px-4 text-center">
            <span class="text-orange-600 font-bold uppercase text-xs tracking-widest mb-2 block">Log√≠stica Zoot</span>
            <h2 class="text-3xl font-extrabold mb-8 text-gray-900">Rastrea tu Pedido</h2>
            
            <div class="max-w-xl mx-auto relative">
                <input type="text" id="order-search" placeholder="Ingresa tu ID (Ej: ZOOT999)" class="w-full pl-6 pr-32 py-5 border-none bg-white rounded-2xl shadow-lg shadow-gray-200 focus:ring-2 focus:ring-orange-500/50 outline-none text-gray-700 text-lg">
                <button onclick="window.searchOrder()" class="absolute right-2 top-2 bottom-2 bg-orange-600 text-white px-6 rounded-xl font-bold hover:bg-orange-700 transition-colors shadow-md">
                    Buscar
                </button>
            </div>
            
            <div id="order-result" class="max-w-xl mx-auto mt-8 hidden animate-[slideUp_0.3s_ease]"></div>
        </div>
    </section>

    <!-- Admin Section -->
    <section id="admin" class="py-24 bg-gray-900 min-h-screen">
        <div class="container mx-auto px-4">
            <!-- Admin Login -->
            <div id="admin-login" class="max-w-md mx-auto bg-gray-800 p-10 rounded-3xl shadow-2xl border border-gray-700">
                 <div class="text-center mb-10">
                    <div class="w-20 h-20 gradient-bg rounded-full flex items-center justify-center mx-auto mb-6 shadow-lg shadow-orange-500/20">
                        <i class="fas fa-lock text-3xl text-white"></i>
                    </div>
                    <h3 class="text-2xl font-bold text-white">Acceso Staff</h3>
                    <p class="text-gray-400 text-sm mt-2">Sistema de Gesti√≥n Interna v2.0</p>
                </div>
                <form id="admin-login-form" class="space-y-5">
                    <div class="relative">
                        <i class="fas fa-user absolute left-4 top-4 text-gray-500"></i>
                        <input type="text" id="admin-username" placeholder="Usuario" required class="w-full pl-10 pr-5 py-4 bg-gray-900/50 border border-gray-600 rounded-xl text-white focus:border-orange-500 outline-none transition-colors">
                    </div>
                    <div class="relative">
                        <i class="fas fa-key absolute left-4 top-4 text-gray-500"></i>
                        <input type="password" id="admin-password" placeholder="Contrase√±a" required class="w-full pl-10 pr-5 py-4 bg-gray-900/50 border border-gray-600 rounded-xl text-white focus:border-orange-500 outline-none transition-colors">
                    </div>
                    <button type="submit" class="w-full gradient-bg text-white py-4 rounded-xl font-bold hover:brightness-110 shadow-lg transform hover:scale-[1.02] transition-all">Entrar al Sistema</button>
                </form>
            </div>

            <!-- Admin Panel -->
            <div id="admin-panel" class="max-w-7xl mx-auto hidden">
                <!-- Header Admin -->
                <div class="bg-gray-800/50 backdrop-blur-md rounded-2xl p-6 mb-8 flex flex-col sm:flex-row justify-between items-center border border-gray-700/50">
                    <div class="mb-4 sm:mb-0">
                        <h3 class="text-2xl font-bold text-white flex items-center gap-3">
                            <span class="w-3 h-3 rounded-full bg-green-500 shadow-[0_0_10px_#22c55e]"></span>
                            Dashboard Central
                        </h3>
                        <p class="text-gray-400 text-sm mt-1 ml-6">Bienvenido, Administrador</p>
                    </div>
                    <div class="flex items-center gap-4">
                         <div class="hidden md:block text-right">
                            <p class="text-xs text-gray-500 uppercase font-bold">Estado del Servidor</p>
                            <p class="text-green-400 font-mono text-sm">ONLINE ‚Ä¢ Firebase</p>
                        </div>
                        <button onclick="window.logoutAdmin()" class="bg-red-500/10 text-red-400 font-bold hover:bg-red-500 hover:text-white px-5 py-2.5 rounded-xl transition-all border border-red-500/20">
                            <i class="fas fa-sign-out-alt mr-2"></i> Salir
                        </button>
                    </div>
                </div>

                <!-- Stats Cards (New Feature) -->
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8" id="admin-stats">
                    <!-- Injected via JS -->
                </div>

                <!-- Navigation Tabs -->
                <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6">
                    <button onclick="window.showAdminTab('productos', this)" class="admin-tab active bg-orange-600 text-white p-4 rounded-xl shadow-lg font-bold transition-all flex items-center justify-center gap-2">
                        <i class="fas fa-box"></i> Productos
                    </button>
                    <button onclick="window.showAdminTab('envios', this)" class="admin-tab bg-gray-800 text-gray-400 hover:bg-gray-700 p-4 rounded-xl font-medium border border-gray-700 transition-all flex items-center justify-center gap-2">
                        <i class="fas fa-truck"></i> Pedidos
                    </button>
                    <button onclick="window.showAdminTab('citas', this)" class="admin-tab bg-gray-800 text-gray-400 hover:bg-gray-700 p-4 rounded-xl font-medium border border-gray-700 transition-all flex items-center justify-center gap-2">
                        <i class="far fa-calendar-alt"></i> Agenda
                    </button>
                    <button onclick="window.showAdminTab('seguridad', this)" class="admin-tab bg-gray-800 text-gray-400 hover:bg-gray-700 p-4 rounded-xl font-medium border border-gray-700 transition-all flex items-center justify-center gap-2">
                        <i class="fas fa-cog"></i> Config
                    </button>
                </div>

                <!-- Content Area -->
                <div class="bg-white text-gray-800 rounded-3xl shadow-2xl border border-gray-700 overflow-hidden min-h-[600px]">
                    <div id="admin-productos" class="admin-content p-8 animate-[fadeIn_0.3s_ease]"></div>
                    <div id="admin-envios" class="admin-content hidden p-8 animate-[fadeIn_0.3s_ease]"></div>
                    <div id="admin-citas" class="admin-content hidden p-8 animate-[fadeIn_0.3s_ease]"></div>
                    <div id="admin-seguridad" class="admin-content hidden p-8 animate-[fadeIn_0.3s_ease] flex items-center justify-center h-full">
                        <div class="text-center text-gray-400">
                            <i class="fas fa-tools text-5xl mb-4"></i>
                            <p>Configuraciones avanzadas en desarrollo</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-gray-900 text-white pt-20 pb-10 mt-auto border-t border-gray-800 relative">
        <div class="container mx-auto px-4 text-center relative z-10">
            <div class="flex justify-center items-center space-x-3 mb-8">
                <div class="w-12 h-12 gradient-bg rounded-xl flex items-center justify-center text-xl">
                    <i class="fas fa-paw"></i>
                </div>
                <span class="text-3xl font-extrabold tracking-tight">ZOOTPETS</span>
            </div>
            <div class="flex justify-center gap-6 mb-10">
                <a href="#" class="w-10 h-10 rounded-full bg-gray-800 flex items-center justify-center hover:bg-orange-600 transition-colors"><i class="fab fa-facebook-f"></i></a>
                <a href="#" class="w-10 h-10 rounded-full bg-gray-800 flex items-center justify-center hover:bg-orange-600 transition-colors"><i class="fab fa-instagram"></i></a>
                <a href="#" class="w-10 h-10 rounded-full bg-gray-800 flex items-center justify-center hover:bg-orange-600 transition-colors"><i class="fab fa-twitter"></i></a>
            </div>
            <p class="text-gray-500 max-w-md mx-auto mb-8 text-sm leading-relaxed">
                Dedicados a mejorar la vida de las mascotas a trav√©s de productos de calidad y atenci√≥n veterinaria experta.
            </p>
            <p class="text-gray-600 text-xs">&copy; 2025 ZOOTPETS Inc. Derechos Reservados.</p>
        </div>
    </footer>

    <!-- UI Overlays -->
    <!-- Cart Sidebar -->
    <div id="cart-overlay" class="fixed inset-0 bg-gray-900/60 z-50 cart-overlay backdrop-blur-sm flex justify-end" onclick="window.toggleCart()">
        <div class="cart-sidebar w-full max-w-md bg-white h-full shadow-2xl flex flex-col" onclick="event.stopPropagation()">
            <div class="p-6 border-b border-gray-100 flex justify-between items-center bg-orange-50/50">
                <h2 class="text-xl font-extrabold text-gray-800 flex items-center gap-3">
                    <i class="fas fa-shopping-bag text-orange-600"></i> Tu Canasta
                </h2>
                <button onclick="window.toggleCart()" class="w-8 h-8 hover:bg-red-50 text-gray-400 hover:text-red-500 rounded-full transition-colors flex items-center justify-center">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div id="cart-items-container" class="flex-1 overflow-y-auto p-6 space-y-4 bg-white scroll-smooth"></div>
            <div id="cart-footer" class="p-6 border-t border-gray-100 bg-gray-50"></div>
        </div>
    </div>

    <!-- Modals -->
    <div id="checkout-modal" class="modal"></div>
    <div id="edit-product-modal" class="modal"></div>

    <!-- FIREBASE LOGIC -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAnalytics } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-analytics.js";
        import { getAuth, signInAnonymously, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, collection, doc, addDoc, updateDoc, deleteDoc, onSnapshot } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        // --- CONFIGURACI√ìN ORIGINAL ---
        const firebaseConfig = {
          apiKey: "AIzaSyAR3LsumI0TL0BgzckHV4CYc_VoxMH00rs",
          authDomain: "zoopets-31dec.firebaseapp.com",
          projectId: "zoopets-31dec",
          storageBucket: "zoopets-31dec.firebasestorage.app",
          messagingSenderId: "1038605311322",
          appId: "1:1038605311322:web:c7b560f16741374d4be763",
          measurementId: "G-N19T5XM9BW"
        };

        // --- GLOBAL HELPERS ---
        window.showNotification = (msg, type = 'success') => {
            const icons = { success: 'fa-check-circle', error: 'fa-exclamation-circle', info: 'fa-info-circle', warning: 'fa-bolt' };
            const colors = { success: 'bg-green-600', error: 'bg-red-500', info: 'bg-blue-600', warning: 'bg-orange-500' };
            
            const div = document.createElement('div'); 
            div.className = `fixed top-24 right-6 px-6 py-4 rounded-2xl shadow-2xl text-white font-bold z-[4000] animate-[slideUp_0.4s_ease] flex items-center gap-3 ${colors[type]} backdrop-blur-md bg-opacity-95 border border-white/20 max-w-xs`; 
            div.innerHTML = `<i class="fas ${icons[type]} text-xl"></i> <span>${msg}</span>`;
            document.body.appendChild(div); 
            setTimeout(() => {
                div.style.opacity = '0';
                div.style.transform = 'translateY(-20px)';
                setTimeout(() => div.remove(), 300);
            }, 3500);
        };

        // Initialize
        let app, auth, db, analytics;
        const appId = 'zoopets-production';
        
        // State Management
        let cart = JSON.parse(localStorage.getItem('zootpetsCart')) || [];
        let currentFilter = 'todos';
        let isAdminLoggedIn = localStorage.getItem('isAdmin') === 'true';
        let isOffline = false;
        let products = [];
        let orders = [];
        let appointments = [];

        // Data Persistence
        const saveLocal = () => {
            localStorage.setItem('zootData_products', JSON.stringify(products));
            localStorage.setItem('zootData_orders', JSON.stringify(orders));
            localStorage.setItem('zootData_appts', JSON.stringify(appointments));
        };

        const loadLocal = () => {
            products = JSON.parse(localStorage.getItem('zootData_products') || '[]');
            orders = JSON.parse(localStorage.getItem('zootData_orders') || '[]');
            appointments = JSON.parse(localStorage.getItem('zootData_appts') || '[]');
        };

        const toggleOfflineMode = (status) => {
            isOffline = status;
            const badge = document.getElementById('offline-badge');
            if(status) badge.classList.add('visible');
            else badge.classList.remove('visible');
        };

        // --- BOOTSTRAP APP ---
        try {
            app = initializeApp(firebaseConfig);
            analytics = getAnalytics(app); // Analytics inicializado aqu√≠
            auth = getAuth(app);
            db = getFirestore(app);
            
            signInAnonymously(auth).then(() => {
                console.log("üî• Firebase Conectado");
            }).catch(err => {
                throw err; // Trigger offline mode
            });

            onAuthStateChanged(auth, user => {
                if(user) setupRealtimeListeners();
            });

        } catch (e) {
            console.warn("‚ö†Ô∏è Modo Offline Activado:", e);
            toggleOfflineMode(true);
            loadLocal();
            if(products.length === 0) seedLocalData(); // Demo data
            initUI();
        }

        function setupRealtimeListeners() {
            const refs = {
                products: collection(db, 'artifacts', appId, 'public', 'data', 'products'),
                orders: collection(db, 'artifacts', appId, 'public', 'data', 'orders'),
                appts: collection(db, 'artifacts', appId, 'public', 'data', 'appointments')
            };

            onSnapshot(refs.products, sn => {
                products = sn.docs.map(d => ({id:d.id, ...d.data()}));
                saveLocal();
                window.renderProducts();
                if(isAdminLoggedIn) window.renderAdminProducts();
                removeLoader();
            }, err => handleOfflineError(err));

            onSnapshot(refs.orders, sn => {
                orders = sn.docs.map(d => ({id:d.id, ...d.data()}));
                saveLocal();
                if(isAdminLoggedIn) window.renderAdminOrders();
            }, err => console.warn("Orders offline"));

            onSnapshot(refs.appts, sn => {
                appointments = sn.docs.map(d => ({id:d.id, ...d.data()}));
                saveLocal();
                if(isAdminLoggedIn) window.renderAdminAppointments();
            }, err => console.warn("Appts offline"));
        }

        function handleOfflineError(err) {
            console.log("Connection lost, switching to local");
            toggleOfflineMode(true);
            loadLocal();
            if(products.length === 0) seedLocalData();
            initUI();
        }

        function removeLoader() {
            const l = document.getElementById('loader');
            if(l) { l.style.opacity = '0'; setTimeout(() => l.remove(), 500); }
        }

        function initUI() {
            window.renderProducts();
            window.renderCart();
            window.renderAdminPanel();
            removeLoader();
        }

        // --- ACTIONS (CRUD) ---
        window.addProductToDB = async (data) => {
            if(isOffline) {
                products.push({id: `loc_${Date.now()}`, ...data});
                saveLocal(); refreshUI();
                window.showNotification("Guardado localmente", "warning");
                return;
            }
            try { await addDoc(collection(db, 'artifacts', appId, 'public', 'data', 'products'), data); window.showNotification("Producto agregado"); }
            catch(e) { window.addProductToDB(data); } // Retry local
        };

        window.updateProductInDB = async (id, data) => {
            if(isOffline || id.startsWith('loc_')) {
                const idx = products.findIndex(p=>p.id===id);
                if(idx>=0) { products[idx] = {...products[idx], ...data}; saveLocal(); refreshUI(); }
                return;
            }
            try { await updateDoc(doc(db, 'artifacts', appId, 'public', 'data', 'products', id), data); window.showNotification("Producto actualizado"); }
            catch(e) { toggleOfflineMode(true); window.updateProductInDB(id, data); }
        };

        window.deleteProductFromDB = async (id) => {
            if(!confirm("¬øEliminar este producto permanentemente?")) return;
            if(isOffline || id.startsWith('loc_')) {
                products = products.filter(p=>p.id!==id);
                saveLocal(); refreshUI();
                window.showNotification("Producto eliminado", "info");
                return;
            }
            try { await deleteDoc(doc(db, 'artifacts', appId, 'public', 'data', 'products', id)); window.showNotification("Producto eliminado", "info"); }
            catch(e) { toggleOfflineMode(true); window.deleteProductFromDB(id); }
        };

        window.addOrderToDB = async (data) => {
            if(isOffline) {
                orders.push({id:`ord_${Date.now()}`, ...data});
                saveLocal();
                if(isAdminLoggedIn) window.renderAdminOrders();
            } else {
                try { await addDoc(collection(db, 'artifacts', appId, 'public', 'data', 'orders'), data); }
                catch(e) { isOffline=true; window.addOrderToDB(data); }
            }
        };
        
        window.addAppointmentToDB = async (data) => {
             if(isOffline) {
                 appointments.push({id:`apt_${Date.now()}`, ...data});
                 saveLocal();
                 if(isAdminLoggedIn) window.renderAdminAppointments();
             } else {
                 try { await addDoc(collection(db, 'artifacts', appId, 'public', 'data', 'appointments'), data); }
                 catch(e) { isOffline=true; window.addAppointmentToDB(data); }
             }
        };

        // Update Helper
        window.updateOrderInDB = async (id, status) => {
            if(isOffline || id.startsWith('ord_')) {
                const o = orders.find(x=>x.id===id); if(o) o.status=status; saveLocal(); if(isAdminLoggedIn) window.renderAdminOrders();
            } else { try { await updateDoc(doc(db, 'artifacts', appId, 'public', 'data', 'orders', id), {status}); } catch(e){} }
        };
        
        // Delete Helper (Genericish)
        window.deleteGeneric = async (col, id) => {
             if(isOffline || id.startsWith('loc_') || id.startsWith('ord_') || id.startsWith('apt_')) {
                 if(col === 'orders') orders = orders.filter(x=>x.id!==id);
                 if(col === 'appointments') appointments = appointments.filter(x=>x.id!==id);
                 saveLocal(); refreshUI();
             } else { try { await deleteDoc(doc(db, 'artifacts', appId, 'public', 'data', col, id)); } catch(e){} }
        };

        function refreshUI() {
            window.renderProducts();
            if(isAdminLoggedIn) { window.renderAdminProducts(); window.renderAdminOrders(); window.renderAdminAppointments(); }
        }

        // --- UI RENDERERS ---
        window.renderProducts = () => {
            const grid = document.getElementById('products-grid');
            const search = document.getElementById('search-product')?.value.toLowerCase() || '';
            
            let filtered = currentFilter === 'todos' ? products : products.filter(p => p.category === currentFilter);
            if (search) filtered = filtered.filter(p => p.name.toLowerCase().includes(search));

            grid.innerHTML = filtered.length ? filtered.map(p => `
                <div class="bg-white rounded-[2rem] shadow-sm hover:shadow-xl border border-gray-100 overflow-hidden card-hover flex flex-col h-full group relative">
                    <div class="relative pt-[90%] bg-gray-50 overflow-hidden">
                        <img src="${p.image}" onerror="this.src='https://placehold.co/400x400/orange/white?text=ZOOT'" class="absolute top-0 left-0 w-full h-full object-cover group-hover:scale-110 transition-transform duration-700">
                        <span class="absolute top-4 left-4 bg-white/90 backdrop-blur px-3 py-1 rounded-full text-xs font-extrabold text-gray-800 uppercase shadow-sm tracking-wider border border-gray-100">
                            ${p.category}
                        </span>
                    </div>
                    <div class="p-6 flex flex-col flex-grow relative z-10 bg-white">
                        <h3 class="text-xl font-bold text-gray-800 mb-2 leading-tight">${p.name}</h3>
                        <p class="text-gray-500 text-sm mb-6 line-clamp-2 flex-grow font-medium">${p.description}</p>
                        <div class="flex items-center justify-between mt-auto">
                            <div>
                                <span class="block text-xs text-gray-400 font-bold uppercase">Precio</span>
                                <span class="text-2xl font-black text-gray-900">$${p.price}</span>
                            </div>
                            <button onclick="window.addToCart('${p.id}')" class="bg-gray-900 text-white w-12 h-12 rounded-2xl flex items-center justify-center hover:bg-orange-600 hover:scale-110 hover:rotate-3 transition-all shadow-lg shadow-gray-200">
                                <i class="fas fa-plus"></i>
                            </button>
                        </div>
                    </div>
                </div>`).join('') 
                : `
                <div class="col-span-full py-24 text-center text-gray-400 flex flex-col items-center justify-center">
                    <div class="text-6xl mb-4 opacity-30">üîç</div>
                    <p class="text-xl font-medium">No encontramos productos que coincidan.</p>
                    <button onclick="document.getElementById('search-product').value=''; window.searchProducts()" class="mt-4 text-orange-600 font-bold hover:underline">Ver todo el cat√°logo</button>
                </div>`;
        };

        window.filterProducts = (cat, btn) => {
            currentFilter = cat;
            document.querySelectorAll('.filter-btn').forEach(b => { 
                b.classList.remove('bg-gray-900', 'text-white', 'active'); 
                b.classList.add('text-gray-500', 'hover:bg-orange-50', 'hover:text-orange-600'); 
            });
            btn.classList.remove('text-gray-500', 'hover:bg-orange-50', 'hover:text-orange-600');
            btn.classList.add('bg-gray-900', 'text-white', 'active');
            window.renderProducts();
        };
        window.searchProducts = () => window.renderProducts();

        // --- CART LOGIC ---
        window.toggleCart = () => document.body.classList.toggle('cart-open');
        
        window.addToCart = (id) => {
            const prod = products.find(p => p.id === id);
            const item = cart.find(i => i.id === id);
            if(item) item.quantity++; else cart.push({...prod, quantity: 1});
            saveCart(); 
            window.renderCart(); 
            window.showNotification(`${prod.name} a√±adido`);
            
            // Animation bump
            const icon = document.getElementById('cart-icon');
            icon.classList.remove('text-gray-700');
            icon.classList.add('text-orange-600', 'animate-bounce-short');
            setTimeout(() => {
                icon.classList.remove('text-orange-600', 'animate-bounce-short');
                icon.classList.add('text-gray-700');
            }, 500);
        };

        window.removeFromCart = (id) => { cart = cart.filter(i => i.id !== id); saveCart(); window.renderCart(); };
        window.updateQuantity = (id, chg) => {
            const item = cart.find(i => i.id === id);
            if(item) { item.quantity += chg; if(item.quantity <= 0) window.removeFromCart(id); else { saveCart(); window.renderCart(); } }
        };
        
        function saveCart() { localStorage.setItem('zootpetsCart', JSON.stringify(cart)); }

        window.renderCart = () => {
            const container = document.getElementById('cart-items-container');
            const footer = document.getElementById('cart-footer');
            const badge = document.getElementById('cart-count');
            const count = cart.reduce((s, i) => s + i.quantity, 0);
            
            badge.textContent = count;
            badge.classList.toggle('scale-0', count === 0);
            
            if(cart.length === 0) {
                container.innerHTML = `
                    <div class="text-center py-20 flex flex-col items-center opacity-50">
                        <i class="fas fa-shopping-basket text-6xl mb-4 text-gray-300"></i>
                        <p class="font-medium text-gray-500">Tu canasta est√° vac√≠a</p>
                        <button onclick="window.toggleCart(); window.scrollToSection('productos')" class="mt-4 px-6 py-2 bg-gray-100 rounded-full text-sm font-bold hover:bg-gray-200">Ir a la tienda</button>
                    </div>`;
                footer.innerHTML = '';
            } else {
                container.innerHTML = cart.map(i => `
                    <div class="flex gap-4 items-center bg-white p-4 rounded-2xl border border-gray-50 shadow-sm transition-all hover:border-orange-200">
                        <img src="${i.image}" class="w-16 h-16 rounded-xl object-cover border border-gray-100">
                        <div class="flex-1">
                            <div class="font-bold text-sm text-gray-800 mb-1">${i.name}</div>
                            <div class="text-xs text-orange-600 font-black">$${i.price}</div>
                        </div>
                        <div class="flex flex-col items-end gap-2">
                            <div class="flex items-center gap-2 bg-gray-100 rounded-lg p-1">
                                <button onclick="window.updateQuantity('${i.id}', -1)" class="w-6 h-6 hover:bg-white rounded shadow-sm font-bold text-gray-600 flex items-center justify-center">-</button>
                                <span class="font-bold text-sm w-4 text-center">${i.quantity}</span>
                                <button onclick="window.updateQuantity('${i.id}', 1)" class="w-6 h-6 hover:bg-white rounded shadow-sm font-bold text-gray-600 flex items-center justify-center">+</button>
                            </div>
                        </div>
                    </div>`).join('');
                    
                const total = cart.reduce((s, i) => s + (i.price * i.quantity), 0);
                footer.innerHTML = `
                    <div class="space-y-3 mb-6">
                        <div class="flex justify-between text-gray-500 text-sm"><span>Subtotal</span><span>$${total.toFixed(2)}</span></div>
                        <div class="flex justify-between font-black text-xl text-gray-900 pt-3 border-t border-gray-200"><span>Total</span><span>$${total.toFixed(2)}</span></div>
                    </div>
                    <button onclick="window.showCheckoutForm()" class="w-full gradient-bg text-white py-4 rounded-xl font-bold hover:shadow-lg hover:shadow-orange-500/30 hover:brightness-110 transition-all flex justify-center items-center gap-2">
                        <span>Pagar Ahora</span> <i class="fas fa-arrow-right"></i>
                    </button>
                `;
            }
        };

        // --- CHECKOUT ---
        window.showCheckoutForm = () => {
            const modal = document.getElementById('checkout-modal');
            modal.innerHTML = `
            <div class="bg-white rounded-3xl max-w-md w-full mx-4 relative overflow-hidden shadow-2xl">
                <div class="p-8">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="font-extrabold text-2xl text-gray-800">Finalizar Compra</h3>
                        <button onclick="document.getElementById('checkout-modal').classList.remove('show')" class="text-gray-400 hover:text-red-500"><i class="fas fa-times text-xl"></i></button>
                    </div>
                    
                    <form id="checkout-form" class="space-y-4">
                        <div class="space-y-1">
                            <label class="text-xs font-bold text-gray-500 uppercase ml-2">Datos de Contacto</label>
                            <input id="c-name" placeholder="Nombre completo" class="w-full p-4 bg-gray-50 border-none rounded-xl focus:ring-2 focus:ring-orange-500/50 outline-none" required>
                            <input id="c-phone" placeholder="Tel√©fono" class="w-full p-4 bg-gray-50 border-none rounded-xl focus:ring-2 focus:ring-orange-500/50 outline-none" required>
                        </div>
                        <div class="space-y-1">
                            <label class="text-xs font-bold text-gray-500 uppercase ml-2">Entrega</label>
                            <textarea id="c-addr" placeholder="Direcci√≥n completa de entrega" class="w-full p-4 bg-gray-50 border-none rounded-xl focus:ring-2 focus:ring-orange-500/50 outline-none h-24 resize-none" required></textarea>
                        </div>
                        
                        <div class="bg-orange-50 p-4 rounded-xl flex justify-between items-center border border-orange-100 mt-4">
                            <span class="text-sm font-bold text-gray-600">Monto a Pagar</span>
                            <span class="text-2xl font-black text-orange-600">$${cart.reduce((s,i)=>s+(i.price*i.quantity),0)}</span>
                        </div>
                        
                        <button type="submit" class="w-full gradient-bg text-white py-4 rounded-xl font-bold text-lg hover:scale-[1.02] transition-all shadow-lg mt-2">
                            Confirmar Pedido üì¶
                        </button>
                    </form>
                </div>
            </div>`;
            modal.classList.add('show');
            
            document.getElementById('checkout-form').addEventListener('submit', async e => {
                e.preventDefault();
                const btn = e.target.querySelector('button[type="submit"]');
                btn.innerHTML = '<i class="fas fa-circle-notch fa-spin"></i> Procesando...';
                btn.disabled = true;

                const order = { 
                    orderId: 'Z'+Date.now().toString().slice(-5), 
                    customer: document.getElementById('c-name').value, 
                    phone: document.getElementById('c-phone').value, 
                    address: document.getElementById('c-addr').value, 
                    total: cart.reduce((s,i)=>s+(i.price*i.quantity),0), 
                    status: 'Recibido', 
                    items: cart,
                    date: new Date().toLocaleDateString()
                };
                
                await window.addOrderToDB(order);
                
                // Send WhatsApp
                let msg = `üê∂ *NUEVO PEDIDO ZOOTPETS* üê±\n\nüÜî ID: ${order.orderId}\nüë§ Cliente: ${order.customer}\nüìû Tel: ${order.phone}\nüìç Direcci√≥n: ${order.address}\nüí∞ Total: $${order.total}\n\nüìù *Detalle:*\n${order.items.map(i => `- ${i.name} x${i.quantity}`).join('\n')}`;
                const waURL = `https://wa.me/5212452070033?text=${encodeURIComponent(msg)}`;
                
                // Success Flow
                document.getElementById('checkout-modal').classList.remove('show');
                cart = []; saveCart(); window.renderCart(); window.toggleCart();
                
                // Nice alert
                const confirmed = confirm(`¬°Pedido Recibido!\n\nTu ID de rastreo es: ${order.orderId}\n\n¬øDeseas enviar el detalle por WhatsApp al veterinario?`);
                if(confirmed) window.open(waURL, '_blank');
                
                window.scrollToSection('seguimiento');
                document.getElementById('order-search').value = order.orderId;
                window.searchOrder();
            });
        };

        // --- TRACKING ---
        window.searchOrder = () => {
             const id = document.getElementById('order-search').value.trim().toUpperCase();
             const o = orders.find(x => x.orderId.toUpperCase() === id || x.id === id);
             const res = document.getElementById('order-result');
             
             res.classList.remove('hidden');
             
             if(o) {
                const steps = ['Recibido', 'Preparando', 'En Camino', 'Entregado'];
                const currentIdx = steps.findIndex(s => s.toLowerCase() === o.status.toLowerCase()) !== -1 ? steps.findIndex(s => s.toLowerCase() === o.status.toLowerCase()) : 0;
                
                res.innerHTML = `
                <div class="bg-white p-8 rounded-3xl shadow-xl border border-gray-100">
                    <div class="flex justify-between items-center mb-6 pb-6 border-b border-gray-100">
                         <div>
                             <p class="text-xs text-gray-400 font-bold uppercase tracking-wider">Pedido #${o.orderId}</p>
                             <h3 class="text-2xl font-bold text-gray-800 mt-1">${o.status}</h3>
                         </div>
                         <div class="text-right">
                             <p class="text-xs text-gray-400 font-bold uppercase tracking-wider">Total</p>
                             <p class="text-xl font-black text-orange-600">$${o.total}</p>
                         </div>
                    </div>
                    
                    <!-- Progress Bar Visualization -->
                    <div class="flex justify-between mb-2 px-2">
                        ${steps.map((s, i) => `<div class="text-xs font-bold ${i <= currentIdx ? 'text-orange-600' : 'text-gray-300'}">${s}</div>`).join('')}
                    </div>
                    <div class="h-3 bg-gray-100 rounded-full overflow-hidden mb-6">
                        <div class="h-full gradient-bg transition-all duration-1000" style="width: ${((currentIdx + 1) / steps.length) * 100}%"></div>
                    </div>

                    <div class="bg-gray-50 p-4 rounded-xl text-sm text-gray-600 space-y-2">
                        <p><i class="fas fa-user mr-2 text-gray-400"></i> ${o.customer}</p>
                        <p><i class="fas fa-map-marker-alt mr-2 text-gray-400"></i> ${o.address}</p>
                    </div>
                </div>`;
             } else {
                res.innerHTML = `
                <div class="text-center text-gray-400 py-6 bg-white rounded-3xl shadow-lg">
                    <span class="text-5xl block mb-3">üòï</span>
                    <p class="font-bold text-gray-800">No encontramos ese pedido</p>
                    <p class="text-sm">Verifica que el ID sea correcto (Ej: Z12345)</p>
                </div>`;
             }
        };

        // --- APPOINTMENTS ---
        document.getElementById('appointment-form').addEventListener('submit', async e => {
            e.preventDefault();
            const appt = {
                owner: document.getElementById('owner-name').value,
                phone: document.getElementById('owner-phone').value,
                pet: document.getElementById('pet-name').value,
                type: document.getElementById('pet-type').value,
                reason: document.getElementById('appointment-reason').value,
                address: document.getElementById('appointment-address').value,
                date: document.getElementById('appointment-date').value,
                time: document.getElementById('appointment-time').value
            };
            
            await window.addAppointmentToDB(appt);
            
            let msg = `üè• *CITA ZOOTPETS* ü©∫\n\nüë§ Due√±o: ${appt.owner}\nüêæ Mascota: ${appt.pet} (${appt.type})\nüìã Motivo: ${appt.reason}\nüìÖ Fecha: ${appt.date}\n‚è∞ Hora: ${appt.time}`;
            if(appt.address) msg += `\nüìç Direcci√≥n: ${appt.address}`;
            
            window.open(`https://wa.me/5212452070033?text=${encodeURIComponent(msg)}`, '_blank');
            e.target.reset();
            window.showNotification("¬°Cita pre-registrada! WhatsApp abierto.");
        });
        
        window.handleReasonChange = () => {
             const val = document.getElementById('appointment-reason').value;
             const addr = document.getElementById('address-container');
             if(val.includes('Domicilio')) {
                 addr.classList.remove('hidden');
                 document.getElementById('appointment-address').setAttribute('required', 'true');
             } else {
                 addr.classList.add('hidden');
                 document.getElementById('appointment-address').removeAttribute('required');
             }
        };

        // --- ADMIN ---
        document.getElementById('admin-login-form').addEventListener('submit', e => {
            e.preventDefault();
            // Simple hardcoded auth for demo (user's request)
            if(document.getElementById('admin-username').value === 'admin' && document.getElementById('admin-password').value === 'password123') {
                isAdminLoggedIn = true; 
                localStorage.setItem('isAdmin', 'true'); 
                window.renderAdminPanel();
                window.showNotification("Bienvenido Staff", "success");
            } else window.showNotification('Credenciales inv√°lidas', 'error');
        });

        window.logoutAdmin = () => { isAdminLoggedIn = false; localStorage.removeItem('isAdmin'); window.renderAdminPanel(); };

        window.renderAdminPanel = () => {
            if(!isAdminLoggedIn) { 
                document.getElementById('admin-login').classList.remove('hidden'); 
                document.getElementById('admin-panel').classList.add('hidden'); 
                return; 
            }
            document.getElementById('admin-login').classList.add('hidden'); 
            document.getElementById('admin-panel').classList.remove('hidden');
            
            // Render stats
            const totalSales = orders.reduce((acc, o) => acc + Number(o.total), 0);
            document.getElementById('admin-stats').innerHTML = `
                <div class="bg-gray-800 p-6 rounded-2xl border border-gray-700">
                    <p class="text-gray-400 text-xs font-bold uppercase">Ventas Totales</p>
                    <h4 class="text-3xl font-bold text-white mt-1">$${totalSales}</h4>
                </div>
                <div class="bg-gray-800 p-6 rounded-2xl border border-gray-700">
                    <p class="text-gray-400 text-xs font-bold uppercase">Pedidos Activos</p>
                    <h4 class="text-3xl font-bold text-white mt-1">${orders.length}</h4>
                </div>
                <div class="bg-gray-800 p-6 rounded-2xl border border-gray-700">
                    <p class="text-gray-400 text-xs font-bold uppercase">Citas Pendientes</p>
                    <h4 class="text-3xl font-bold text-white mt-1">${appointments.length}</h4>
                </div>
            `;

            window.renderAdminProducts();
        };

        // Admin Tabs Logic
        window.showAdminTab = (tab, btn) => {
            document.querySelectorAll('.admin-content').forEach(e => e.classList.add('hidden'));
            document.getElementById(`admin-${tab}`).classList.remove('hidden');
            
            document.querySelectorAll('.admin-tab').forEach(b => { 
                b.classList.remove('bg-orange-600','text-white', 'active', 'shadow-lg'); 
                b.classList.add('bg-gray-800','text-gray-400'); 
            });
            btn.classList.remove('bg-gray-800','text-gray-400'); 
            btn.classList.add('bg-orange-600','text-white', 'active', 'shadow-lg');
            
            if(tab === 'productos') window.renderAdminProducts();
            if(tab === 'envios') window.renderAdminOrders();
            if(tab === 'citas') window.renderAdminAppointments();
        };

        window.renderAdminProducts = () => {
            document.getElementById('admin-productos').innerHTML = `
            <div class="grid lg:grid-cols-3 gap-8">
                <!-- Form Create -->
                <div class="lg:col-span-1">
                    <div class="bg-gray-50 p-6 rounded-2xl border border-gray-200 sticky top-4">
                        <h4 class="font-bold text-xl mb-4 text-gray-800 flex items-center gap-2"><i class="fas fa-plus-circle text-orange-600"></i> Agregar Producto</h4>
                        <form id="add-prod-form" class="space-y-4">
                            <input id="np-name" placeholder="Nombre del producto" class="w-full p-3 bg-white border border-gray-200 rounded-xl outline-none focus:border-orange-500 transition-colors" required>
                            <div class="grid grid-cols-2 gap-2">
                                <input id="np-price" type="number" placeholder="Precio" class="w-full p-3 bg-white border border-gray-200 rounded-xl outline-none focus:border-orange-500 transition-colors" required>
                                <select id="np-cat" class="w-full p-3 bg-white border border-gray-200 rounded-xl outline-none focus:border-orange-500 transition-colors">
                                    <option value="alimento">Alimento</option>
                                    <option value="juguetes">Juguetes</option>
                                    <option value="medicamentos">Salud</option>
                                    <option value="accesorios">Accesorios</option>
                                </select>
                            </div>
                            <div class="border-2 border-dashed border-gray-300 rounded-xl p-4 text-center hover:bg-white transition-colors cursor-pointer relative">
                                <input type="file" id="np-file" accept="image/*" class="absolute inset-0 w-full h-full opacity-0 cursor-pointer">
                                <p class="text-xs text-gray-500 font-bold uppercase"><i class="fas fa-camera mb-1 block text-2xl"></i> Subir Foto</p>
                            </div>
                            <textarea id="np-desc" placeholder="Descripci√≥n corta" class="w-full p-3 bg-white border border-gray-200 rounded-xl outline-none focus:border-orange-500 h-20 resize-none"></textarea>
                            <button type="submit" class="w-full bg-gray-900 text-white py-3 rounded-xl hover:bg-orange-600 transition-colors font-bold shadow-md">Guardar Producto</button>
                        </form>
                    </div>
                </div>
                
                <!-- List -->
                <div class="lg:col-span-2 space-y-3 max-h-[600px] overflow-y-auto pr-2 custom-scroll">
                    ${products.map(p => `
                        <div class="flex justify-between items-center bg-white p-4 rounded-2xl border border-gray-100 shadow-sm hover:shadow-md transition-all">
                            <div class="flex gap-4 items-center">
                                <img src="${p.image}" class="w-16 h-16 rounded-xl object-cover bg-gray-100">
                                <div>
                                    <div class="font-bold text-gray-800">${p.name}</div>
                                    <div class="text-xs font-bold text-gray-400 uppercase mt-1 bg-gray-50 inline-block px-2 py-1 rounded">$${p.price} ‚Ä¢ ${p.category}</div>
                                </div>
                            </div>
                            <div class="flex gap-2">
                                <button onclick="window.editProduct('${p.id}')" class="w-10 h-10 rounded-xl bg-blue-50 text-blue-600 hover:bg-blue-500 hover:text-white transition-all flex items-center justify-center"><i class="fas fa-pen"></i></button>
                                <button onclick="window.deleteProductFromDB('${p.id}')" class="w-10 h-10 rounded-xl bg-red-50 text-red-600 hover:bg-red-500 hover:text-white transition-all flex items-center justify-center"><i class="fas fa-trash"></i></button>
                            </div>
                        </div>`).join('')}
                    ${products.length === 0 ? '<div class="text-center py-10 text-gray-400">No hay productos en el inventario.</div>' : ''}
                </div>
            </div>`;
            
            // Bind Form
            const form = document.getElementById('add-prod-form');
            if(form) form.addEventListener('submit', async e => {
                e.preventDefault();
                const file = document.getElementById('np-file').files[0];
                const img = file ? await processImage(file) : 'https://placehold.co/400?text=ZOOT';
                await window.addProductToDB({
                    name: document.getElementById('np-name').value,
                    price: Number(document.getElementById('np-price').value),
                    category: document.getElementById('np-cat').value,
                    description: document.getElementById('np-desc').value,
                    image: img
                });
                form.reset();
            });
        };

        window.renderAdminOrders = () => {
            const container = document.getElementById('admin-envios');
            if(!orders.length) { container.innerHTML = '<div class="text-center text-gray-400 font-medium py-10">Sin pedidos activos</div>'; return; }
            
            container.innerHTML = `
            <div class="space-y-4">
                ${orders.map(o => `
                <div class="bg-white p-6 rounded-2xl shadow-sm border-l-4 ${o.status === 'nuevo' ? 'border-green-500' : 'border-blue-500'} flex flex-col md:flex-row justify-between items-start md:items-center gap-4">
                    <div>
                        <div class="flex items-center gap-3 mb-1">
                            <span class="bg-gray-900 text-white text-xs font-bold px-2 py-1 rounded uppercase tracking-wider">#${o.orderId}</span>
                            <span class="text-xs text-gray-400 font-bold">${o.date || 'Hoy'}</span>
                        </div>
                        <h4 class="font-bold text-gray-800 text-lg">${o.customer} <span class="text-gray-400 text-sm font-normal">(${o.phone})</span></h4>
                        <p class="text-sm text-gray-500 mt-1"><i class="fas fa-map-pin text-orange-500 mr-1"></i> ${o.address}</p>
                        <div class="mt-3 text-xs font-medium text-gray-400 bg-gray-50 p-2 rounded inline-block">
                            ${o.items.map(i=>`${i.quantity}x ${i.name}`).join(', ')}
                        </div>
                    </div>
                    <div class="flex flex-col items-end gap-3 min-w-[150px]">
                        <span class="text-2xl font-black text-orange-600">$${o.total}</span>
                        <select onchange="window.updateOrderInDB('${o.id}', this.value)" class="text-xs font-bold bg-gray-100 border-none rounded-lg p-2 outline-none cursor-pointer hover:bg-gray-200">
                            <option value="Recibido" ${o.status==='Recibido'?'selected':''}>üü° Recibido</option>
                            <option value="Preparando" ${o.status==='Preparando'?'selected':''}>üü† Preparando</option>
                            <option value="En Camino" ${o.status==='En Camino'?'selected':''}>üöö En Camino</option>
                            <option value="Entregado" ${o.status==='Entregado'?'selected':''}>‚úÖ Entregado</option>
                        </select>
                        <button onclick="window.deleteGeneric('orders', '${o.id}')" class="text-red-400 text-xs hover:text-red-600 underline">Eliminar</button>
                    </div>
                </div>`).join('')}
            </div>`;
        };

        window.renderAdminAppointments = () => {
            const container = document.getElementById('admin-citas');
            if(!appointments.length) { container.innerHTML = '<div class="text-center text-gray-400 font-medium py-10">Sin citas programadas</div>'; return; }
            
            container.innerHTML = `<div class="grid gap-4">${appointments.map(a => `
                <div class="bg-white p-5 rounded-2xl border border-gray-100 flex justify-between items-center shadow-sm">
                    <div>
                        <div class="font-bold text-lg text-gray-800 flex items-center gap-2">
                            ${a.pet} <span class="text-xs bg-orange-100 text-orange-700 px-2 py-0.5 rounded-full">${a.type}</span>
                        </div>
                        <p class="text-sm text-gray-500">Due√±o: ${a.owner} ‚Ä¢ ${a.phone}</p>
                        <p class="text-xs font-bold text-purple-600 mt-1 uppercase tracking-wide">${a.reason}</p>
                    </div>
                    <div class="text-right">
                        <div class="bg-gray-900 text-white px-3 py-1 rounded-lg font-bold mb-2 text-sm">${a.date}</div>
                        <div class="text-gray-500 font-mono text-sm">${a.time}</div>
                        <button onclick="window.deleteGeneric('appointments', '${a.id}')" class="block mt-2 ml-auto text-red-400 hover:text-red-600 text-xs"><i class="fas fa-trash"></i></button>
                    </div>
                </div>`).join('')}</div>`;
        };

        window.editProduct = (id) => {
            const p = products.find(x => x.id === id);
            if(!p) return;
            const modal = document.getElementById('edit-product-modal');
            
            modal.innerHTML = `
            <div class="bg-white p-8 rounded-3xl max-w-md w-full mx-4 shadow-2xl">
                <h3 class="font-bold text-xl mb-6 text-gray-800">Editar Producto</h3>
                <form id="edit-form" class="space-y-4">
                    <div class="flex items-center gap-4 mb-4">
                        <img src="${p.image}" class="w-16 h-16 rounded-xl object-cover border">
                        <div class="flex-1">
                             <label class="block text-xs font-bold text-orange-600 mb-1 uppercase">Cambiar Imagen</label>
                             <input type="file" id="ep-file" class="text-xs text-gray-500">
                        </div>
                    </div>
                    <input id="ep-name" value="${p.name}" class="w-full p-3 bg-gray-50 rounded-xl outline-none focus:ring-1 focus:ring-orange-500" placeholder="Nombre">
                    <input id="ep-price" type="number" value="${p.price}" class="w-full p-3 bg-gray-50 rounded-xl outline-none focus:ring-1 focus:ring-orange-500" placeholder="Precio">
                    <select id="ep-cat" class="w-full p-3 bg-gray-50 rounded-xl outline-none">
                         ${['alimento','juguetes','medicamentos','accesorios'].map(c=>`<option value="${c}" ${p.category===c?'selected':''}>${c}</option>`).join('')}
                    </select>
                    <textarea id="ep-desc" class="w-full p-3 bg-gray-50 rounded-xl outline-none h-24 resize-none">${p.description}</textarea>
                    <div class="flex justify-end gap-3 pt-2">
                        <button type="button" onclick="document.getElementById('edit-product-modal').classList.remove('show')" class="px-5 py-2 rounded-xl font-bold text-gray-500 hover:bg-gray-100">Cancelar</button>
                        <button type="submit" class="px-5 py-2 bg-orange-600 text-white rounded-xl font-bold hover:bg-orange-700">Guardar Cambios</button>
                    </div>
                </form>
            </div>`;
            modal.classList.add('show');
            
            document.getElementById('edit-form').addEventListener('submit', async e => {
                e.preventDefault();
                const file = document.getElementById('ep-file').files[0];
                let img = p.image;
                if(file) img = await processImage(file);
                
                await window.updateProductInDB(id, {
                    name: document.getElementById('ep-name').value,
                    price: Number(document.getElementById('ep-price').value),
                    category: document.getElementById('ep-cat').value,
                    description: document.getElementById('ep-desc').value,
                    image: img
                });
                modal.classList.remove('show');
            });
        };

        // --- UTILS ---
        window.scrollToSection = (id) => {
            document.getElementById(id)?.scrollIntoView({behavior: 'smooth'});
            document.getElementById('mobile-menu').classList.add('hidden');
        };
        window.toggleMobileMenu = () => document.getElementById('mobile-menu').classList.toggle('hidden');
        window.mobileNav = (id) => { window.scrollToSection(id); window.toggleMobileMenu(); };

        // Image Logic (Keep small)
        const processImage = (file) => new Promise(resolve => {
            const reader = new FileReader();
            reader.readAsDataURL(file);
            reader.onload = e => {
                const img = new Image(); img.src = e.target.result;
                img.onload = () => {
                    const cvs = document.createElement('canvas');
                    const ctx = cvs.getContext('2d');
                    const max = 400; 
                    const scale = Math.min(max/img.width, max/img.height);
                    cvs.width = img.width * scale; cvs.height = img.height * scale;
                    ctx.drawImage(img,0,0,cvs.width,cvs.height);
                    resolve(cvs.toDataURL('image/jpeg', 0.6));
                };
            };
        });

        // Default Data (Demo)
        const seedLocalData = () => {
            products = [
                {id:"1",name:"Alimento Premium Zoot",price:550,category:"alimento",image:"https://images.unsplash.com/photo-1585559700398-1385b3a8aeb6?auto=format&fit=crop&w=400&q=80",description:"Nutrici√≥n balanceada para adultos."},
                {id:"2",name:"Pelota K9 Resistente",price:120,category:"juguetes",image:"https://images.unsplash.com/photo-1546422401-68b415cbf8de?auto=format&fit=crop&w=400&q=80",description:"Indestructible para mordidas fuertes."},
                {id:"3",name:"Vitaminas Complex",price:280,category:"medicamentos",image:"https://images.unsplash.com/photo-1584017911766-d451b3d0e843?auto=format&fit=crop&w=400&q=80",description:"Suplemento diario."},
                {id:"4",name:"Correa T√°ctica",price:310,category:"accesorios",image:"https://images.unsplash.com/photo-1576201836106-db1758fd1c97?auto=format&fit=crop&w=400&q=80",description:"Control total y seguridad."},
                {id:"5",name:"Cama Ortop√©dica",price:850,category:"accesorios",image:"https://images.unsplash.com/photo-1591946614720-90a587da4a36?auto=format&fit=crop&w=400&q=80",description:"Descanso perfecto."}
            ];
            saveLocal();
        };
    </script>
</body>
</html>
